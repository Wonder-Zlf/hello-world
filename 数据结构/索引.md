# 索引

## 1、为什么要建立索引

1）需要支持大规模数据的查找，数据存储在硬盘上。如果直接对数据记录进行查找，需要耗费大量的时间来从硬盘加载数据 。

2）需要支持多关键字的查找

3）需要支持高效的插入、删除和范围查找



## 2、索引文件

1）记录了关键字和对应数据记录存储在硬盘中的位置

2）比数据记录小得多，查找时被加载到内存中进行查找

3）针对不同关键字的索引文件，支持多关键字查找



## 3、线性索引

是个二元组（关键字，指向记录的指针）的序列，且序列中的关键字有序排列。

![1586796196230](C:\Users\wonde\AppData\Roaming\Typora\typora-user-images\1586796196230.png)



如果索引太大无法加载到内存，则建立二级索引。

![1586796246445](C:\Users\wonde\AppData\Roaming\Typora\typora-user-images\1586796246445.png)



## 4、线性索引不足

插入和删除操作会导致大量数据移动。



## 5、树索引

1）解决线性索引的低效插入删除

2）高效地：

- 插入/删除记录
- 多关键字查找
- 关键字的范围查找



## 6、二叉查找树实现树索引

查找代价：在保持平衡的BST上平均的情况下 O(log n).

困难：让BST保持平衡，也就是每个节点插入都有大量其他节点的调整。



## 7、使用2-3树

### 7.1 原因

2-3 树具有类似于BST的查找性质。
2-3 树的优点在于结点更新的代价较低。

![1586796638427](C:\Users\wonde\AppData\Roaming\Typora\typora-user-images\1586796638427.png)

### 7.2  2-3树的性质

1.一个节点包含一个或两个关键字

2.每个中间节点具有2个孩子 (当它包含1个关键字时) 或具有3个孩子(当它包含2个关键字时).

3.树上的所有叶子都在一个层次上，因此2-3树总是保持高度平衡的.



## 8、使用B树

### 8.1 B树的性质

一棵m阶B-树具有以下性质 :
1）树根或者是一个叶子或者是一个至少具有两个孩子的中间结点
2）除了树根和叶子的每一个结点，具有最少 m/2个、最多 m个孩子.
3）B-树上的所有叶子都在同一个层次，因此B-树总是平衡的。

![1586797128352](C:\Users\wonde\AppData\Roaming\Typora\typora-user-images\1586797128352.png)

### 8.2 其他性质

1）此外，为了减少硬盘的I/O次数，每个B树的结点的大小通常设计成和硬盘读写块的大小相当。

2）一个 B树结点可以有上百个孩子结点.



## 9、B+树

- B+树是一种最常使用的B-Tree的变型 
- B+树的中间结点不存储和特定数据记录相关的内容，而只是记录关键字用于查找
- 叶子结点存储数据记录，或者指向数据记录的指针 
- 所有在同一个层次的结点链成一个链表 

![1586797213246](C:\Users\wonde\AppData\Roaming\Typora\typora-user-images\1586797213246.png)

### 9.1 B+树的属性

1）树根或者是一个叶子或者是一个至少具有两个孩子的中间结点
2）m阶B+-树除了树根和叶子的每一个结点，具有最少 [m/2]个最多 m个孩子，具有最少 [m/2] - 1个，最多 m-1个关键字
3）假设叶子结点存储的记录数最多可存放n个记录，则至少要存放[n/2]个记录(n 不一定等于m - 1)



### 9.2 B+树的优势

1）B+树总是平衡的
2）B+树支持高效的范围查找
3）B+树的树的高度较小，从而大大降低查找过程中硬盘读写的次数-                  